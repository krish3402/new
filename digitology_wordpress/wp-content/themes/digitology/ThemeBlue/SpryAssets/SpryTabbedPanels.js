var Spry;Spry||(Spry={}),Spry.Widget||(Spry.Widget={}),Spry.Widget.TabbedPanels=function(e,t){if(this.element=this.getElement(e),this.defaultTab=0,this.bindings=[],this.tabSelectedClass="TabbedPanelsTabSelected",this.tabHoverClass="TabbedPanelsTabHover",this.tabFocusedClass="TabbedPanelsTabFocused",this.panelVisibleClass="TabbedPanelsContentVisible",this.focusElement=null,this.hasFocus=!1,this.currentTabIndex=0,this.enableKeyboardNavigation=!0,Spry.Widget.TabbedPanels.setOptions(this,t),"number"==typeof this.defaultTab){if(this.defaultTab<0)this.defaultTab=0;else{var a=this.getTabbedPanelCount();this.defaultTab>=a&&(this.defaultTab=a>1?a-1:0)}this.defaultTab=this.getTabs()[this.defaultTab]}this.defaultTab&&(this.defaultTab=this.getElement(this.defaultTab)),this.attachBehaviors()},Spry.Widget.TabbedPanels.prototype.getElement=function(e){return e&&"string"==typeof e?document.getElementById(e):e},Spry.Widget.TabbedPanels.prototype.getElementChildren=function(e){for(var t=[],a=e.firstChild;a;)1==a.nodeType&&t.push(a),a=a.nextSibling;return t},Spry.Widget.TabbedPanels.prototype.addClassName=function(e,t){!e||!t||e.className&&-1!=e.className.search(new RegExp("\\b"+t+"\\b"))||(e.className+=(e.className?" ":"")+t)},Spry.Widget.TabbedPanels.prototype.removeClassName=function(e,t){!e||!t||e.className&&-1==e.className.search(new RegExp("\\b"+t+"\\b"))||(e.className=e.className.replace(new RegExp("\\s*\\b"+t+"\\b","g"),""))},Spry.Widget.TabbedPanels.setOptions=function(e,t,a){if(t)for(var n in t)a&&void 0==t[n]||(e[n]=t[n])},Spry.Widget.TabbedPanels.prototype.getTabGroup=function(){if(this.element){var e=this.getElementChildren(this.element);if(e.length)return e[0]}return null},Spry.Widget.TabbedPanels.prototype.getTabs=function(){var e=[],t=this.getTabGroup();return t&&(e=this.getElementChildren(t)),e},Spry.Widget.TabbedPanels.prototype.getContentPanelGroup=function(){if(this.element){var e=this.getElementChildren(this.element);if(e.length>1)return e[1]}return null},Spry.Widget.TabbedPanels.prototype.getContentPanels=function(){var e=[],t=this.getContentPanelGroup();return t&&(e=this.getElementChildren(t)),e},Spry.Widget.TabbedPanels.prototype.getIndex=function(e,t){if(e=this.getElement(e),e&&t&&t.length)for(var a=0;a<t.length;a++)if(e==t[a])return a;return-1},Spry.Widget.TabbedPanels.prototype.getTabIndex=function(e){var t=this.getIndex(e,this.getTabs());return 0>t&&(t=this.getIndex(e,this.getContentPanels())),t},Spry.Widget.TabbedPanels.prototype.getCurrentTabIndex=function(){return this.currentTabIndex},Spry.Widget.TabbedPanels.prototype.getTabbedPanelCount=function(e){return Math.min(this.getTabs().length,this.getContentPanels().length)},Spry.Widget.TabbedPanels.addEventListener=function(e,t,a,n){try{e.addEventListener?e.addEventListener(t,a,n):e.attachEvent&&e.attachEvent("on"+t,a)}catch(s){}},Spry.Widget.TabbedPanels.prototype.onTabClick=function(e,t){this.showPanel(t)},Spry.Widget.TabbedPanels.prototype.onTabMouseOver=function(e,t){this.addClassName(t,this.tabHoverClass)},Spry.Widget.TabbedPanels.prototype.onTabMouseOut=function(e,t){this.removeClassName(t,this.tabHoverClass)},Spry.Widget.TabbedPanels.prototype.onTabFocus=function(e,t){this.hasFocus=!0,this.addClassName(this.element,this.tabFocusedClass)},Spry.Widget.TabbedPanels.prototype.onTabBlur=function(e,t){this.hasFocus=!1,this.removeClassName(this.element,this.tabFocusedClass)},Spry.Widget.TabbedPanels.ENTER_KEY=13,Spry.Widget.TabbedPanels.SPACE_KEY=32,Spry.Widget.TabbedPanels.prototype.onTabKeyDown=function(e,t){var a=e.keyCode;return!this.hasFocus||a!=Spry.Widget.TabbedPanels.ENTER_KEY&&a!=Spry.Widget.TabbedPanels.SPACE_KEY?!0:(this.showPanel(t),e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1)},Spry.Widget.TabbedPanels.prototype.preorderTraversal=function(e,t){var a=!1;if(e&&(a=t(e),e.hasChildNodes()))for(var n=e.firstChild;!a&&n;){a=this.preorderTraversal(n,t);try{n=n.nextSibling}catch(s){n=null}}return a},Spry.Widget.TabbedPanels.prototype.addPanelEventListeners=function(e,t){var a=this;if(Spry.Widget.TabbedPanels.addEventListener(e,"click",function(t){return a.onTabClick(t,e)},!1),Spry.Widget.TabbedPanels.addEventListener(e,"mouseover",function(t){return a.onTabMouseOver(t,e)},!1),Spry.Widget.TabbedPanels.addEventListener(e,"mouseout",function(t){return a.onTabMouseOut(t,e)},!1),this.enableKeyboardNavigation){var n=null,s=null;this.preorderTraversal(e,function(t){if(1==t.nodeType){var a=e.attributes.getNamedItem("tabindex");if(a)return n=t,!0;s||"a"!=t.nodeName.toLowerCase()||(s=t)}return!1}),n?this.focusElement=n:s&&(this.focusElement=s),this.focusElement&&(Spry.Widget.TabbedPanels.addEventListener(this.focusElement,"focus",function(t){return a.onTabFocus(t,e)},!1),Spry.Widget.TabbedPanels.addEventListener(this.focusElement,"blur",function(t){return a.onTabBlur(t,e)},!1),Spry.Widget.TabbedPanels.addEventListener(this.focusElement,"keydown",function(t){return a.onTabKeyDown(t,e)},!1))}},Spry.Widget.TabbedPanels.prototype.showPanel=function(e){var t=-1;if(t="number"==typeof e?e:this.getTabIndex(e),!(0>!t||t>=this.getTabbedPanelCount())){for(var a=this.getTabs(),n=this.getContentPanels(),s=Math.max(a.length,n.length),i=0;s>i;i++)i!=t&&(a[i]&&this.removeClassName(a[i],this.tabSelectedClass),n[i]&&(this.removeClassName(n[i],this.panelVisibleClass),n[i].style.display="none"));this.addClassName(a[t],this.tabSelectedClass),this.addClassName(n[t],this.panelVisibleClass),n[t].style.display="block",this.currentTabIndex=t}},Spry.Widget.TabbedPanels.prototype.attachBehaviors=function(e){for(var t=this.getTabs(),a=this.getContentPanels(),n=this.getTabbedPanelCount(),s=0;n>s;s++)this.addPanelEventListeners(t[s],a[s]);this.showPanel(this.defaultTab)};